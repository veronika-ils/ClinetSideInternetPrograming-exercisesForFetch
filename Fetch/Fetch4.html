<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fetch4</title>
  <script>
    function fetchPostsAndUsers() {

      fetch("https://jsonplaceholder.typicode.com/posts")
        .then(response => response.json())
        .then(posts => {
          fetch("https://jsonplaceholder.typicode.com/users")
            .then(response => response.json())
            .then(users => {

              let output = "<ul>";
              posts.forEach(post => {
                let user = users.find(user => user.id === post.userId);
                output += "<li>"+post.title+" by <em>"+user.name+"</em></li>";
              });

              output += "</ul>";
              document.getElementById("posts").innerHTML = output;
            })
        })

    }
    async function fetchPostsAndUsersA(){
      let url1 ="https://jsonplaceholder.typicode.com/posts";
      let url2 = "https://jsonplaceholder.typicode.com/users";

      let response1 = await fetch(url1);
      let response2 = await fetch(url2);

      let posts = await response1.json();
      let users = await response2.json();

      let output = "<ul>";
      posts.forEach(post=>{
        let user=users.find(user=> user.id=== post.userId);
        output +="<li>"+post.title+"by <em>"+user.name+"</em></li>"
      })
      output +="</ul>"
      document.getElementById("postsA").innerHTML = output;
    }
    //===============Vtor nacin da se reshi zadacata so async i await=============
    /*async function fetchPostsAndUsersA(){
      let url1 ="https://jsonplaceholder.typicode.com/posts";
      let url2 = "https://jsonplaceholder.typicode.com/users";

      let response1 = await fetch(url1);
      let response2 = await fetch(url2);

      let posts = await response1.json();
      let users = await response2.json();

      let output = "<ul>";
      for (let i=0;i<posts.length;i++){
        for (let j=0;j<users.length;j++){
          if (users[j].id === posts[i].userId){
            output +="<li>"+posts[i].title+"by <em>"+users[j].name+"</em></li>";
            break;
          }
        }
      }

      output +="</ul>"
      document.getElementById("postsA").innerHTML = output;
    }*/
  </script>
</head>
<body>
<h1>Exercise Four - MEDIUM</h1>
<h2>Get Posts with Authors</h2>
<button onclick="fetchPostsAndUsers()">Get Posts with Authors</button>
<div id="posts"></div>
<button onclick="fetchPostsAndUsersA()">Get Posts with Authors(async - await)</button>
<div id="postsA"></div>
</body>
</html>

